{% extends 'layout.html' %}
{% load humanize %}
{% block menu %} 
	{% include 'menu.html' %}
{% endblock %} 
{% load widget_tweaks %}
{% block header %}
 <div class="page-header">
	  <div class="page-block">
		  <div class="row align-items-center">
			  <div class="col-md-8">
				  <div class="page-header-title">
					  <h5 class="m-b-10">Tus paquetes de {{  product.name }}</h5>
					  <p class="m-b-0">Crear nuevo paquete y editar los existentes</p>
				  </div>
			  </div>

		  </div>
	  </div>
  </div>
{% endblock %}

{% block content %}


<div class="row">
	<div class="col-md-12">
		<div class="card">
			<div class="card-header">
				<h5>Crear nuevo plan para {{  product.name }}</h5>
			</div>
			<div class="card-block">
				<form class="form-material" method="post">
						<div class="card">
								<div class="card-block">
									{% csrf_token %}
									<div class="form-group form-default">
										{{ form.individual_sale|add_class:'form-control' }}
										<span class="form-bar"></span>
										<label class="float-label">Tipo de venta</label>
									</div>
									<div class="form-group form-default">
										{{ form.name|add_class:'form-control' }}
										<span class="form-bar"></span>
										<label class="float-label">Producto</label>
									</div>
									<div class="form-group form-default">
										{{ form.price|add_class:'form-control' }}
										<span class="form-bar"></span>
										<label class="float-label">Precio (si es venta por cuentas, ingrese en valor de cada una, si no el valor completo del paquete)</label>
									</div>

									<div class="form-group form-default">
										<label class="float-label">Es renovable?</label>

											{{ form.renewable }}


									</div>
									<div class="form-group form-default">
										{{ form.instructions|add_class:'form-control' }}
										<span class="form-bar"></span>
										<label class="float-label">Condiciones de uso</label>
									</div>
							{{  form.errors }}
							</div>
						</div>
						<input class="btn btn-primary btn-md btn-block waves-effect text-center m-b-20" type="submit" value="Crear nuevo paquete para {{ product.name }}"/>
				</form>
				<!-- /.panel-body -->
			</div>
							<!-- /.panel -->

		</div>
	</div>
</div>
<div class="row">
	<div class="col-lg-12">
		<div class="card">
			<div class="card-header">
				<h5>Listado de paquetes {{  product.name }} activos</h5>
			</div>
			<div class="card-block table-border-style">
				<div class="table-responsive">
					<table class="table table-hover table-normal">
						<thead>
							<tr>
								<th>#</th>
								<th>Nombre</th>
								<th>Precio</th>
								<th>Acciones</th>
							</tr>
						</thead>
					   <tbody>
						   {% for subproduct in subproducts %}
							<tr class="gradeA odd" role="row">
								<td>{{forloop.counter}}</td>
								<td>{{ subproduct.name }}</td>
								<td>${{ subproduct.price|intcomma }}</td>
								<td class="center">
									<a href="{% url 'add-count-package' subproduct.id %}"><i class="fa fa-fw" aria-hidden="true" title="Agregar cuenta"></i></a>
									<a href="{% url 'edit-package' subproduct.id %}"><i class="fa fa-fw" aria-hidden="true" title="Edit"></i></a>
									<a href="#" class="delete"  id="{{ subproduct.id }}"><i class="fa fa-fw  aria-hidden="true" title="Borrar"></i></a>
								</td>
							</tr>
						   {% endfor %}
					   </tbody>
					</table>
				</div>
			</div>
		</div>

	</div>
	<!-- /.col-lg-12 -->
</div>



<script>
$(document).ready( function () {


    $('#id_price').keyup(function(){
    	price = $(this).val()    	
    	$('.price').val(price)
    })
} );

$( ".delete" ).each(function(index) {
    $(this).on("click", function(event){
    	event.preventDefault()     	
     	var id = $(this).attr('id');
     	var mensaje = confirm("Desea desactivar este producto?");		
		if (mensaje) {
			$.get('/delete/SubProduct/'+id ,function(data){    		
	    		alert(data)	    		
	    		location.reload();
	    	})   	
		}
    });
});

</script>

{% endblock %}